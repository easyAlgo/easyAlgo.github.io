define(["app","pagedown-extra/Markdown.Extra","services/mathlex"],function(e){var t="$",n="markdown",r=!0,i="replace",s="</div>",o="easyAlgo",u="markdown-done",a=[],f=function(e){if(typeof MathJax!="undefined"&&MathJax!=undefined){if(a.length>0)while(a.length>0){var t=a.pop();MathJax.Hub.Queue([t[0],MathJax.Hub,t[1]])}e&&MathJax.Hub.Queue([e[0],MathJax.Hub,e[1]])}else a.push([e[0],e[1]])};require(["mathjax"],function(){MathJax.Hub.Config({tex2jax:{inlineMath:[[t,t],["\\(","\\)"]]}}),f()}),e.directive(n,["$compile",function(e){return{restrict:"AE",scope:r,link:function(a,l,c){var h=Markdown.getSanitizingConverter();Markdown.Extra.init(h,{table_class:"table table-hover"}),a.showHelps=[];var p=!1;h.hooks.chain("postConversion",function(e){e=e[i](/(\s|\>|\.|^)(\$)([^$]+)\2(\s|\<|\.|$)/g,function(e,n,s,o,u,a,f){var l=o[i]("&lt;","<");try{var c=MathLex.parse(l);l=MathLex.render(c,"latex")}catch(h){}return p=r,n+t+l+t+u});var n=0;return e=e[i](/\/\/\/(.*)\n((?:.|\n)*?)\n\/\/\//mg,function(e,t,r,i,o){n++;var u="showHelps["+n+"]";return'<div class="help"><span class="title cursor" ng-class="{\'open\' : '+u+'}"ng-click="'+u+" = !"+u+'">'+'<i class="glyphicon glyphicon-question-sign" ng-class="{\'glyphicon-question-sign\' : !'+u+", 'glyphicon-ok-sign' : "+u+'}"></i> '+t+"</span>"+'<div ng-show="'+u+'" class="content">'+r+s+s}),e+"\n"});if(c[n])a.$watch(c[n],function(t){var n=t?h.makeHtml(t):"";l.html(n),e(l.contents())(a);var i=l.find("pre").find("code");angular.forEach(i,function(e){var t=angular.element(e),n=t.attr("class"),i=n==o?{mode:"text/easyAlgo-src"}:CodeMirror.findModeByExtension(n),s=CodeMirror(function(e){t.parent().replaceWith(e)},{value:t.text().trim(),readOnly:r,mode:i?i.mode:""});n!=o&&i&&CodeMirror.autoLoadMode(s,i)}),p&&f(["Typeset",l[0]]),a.$emit(u,l)});else{var d=h.makeHtml(l.text());l.html(d),a.$emit(u,l)}}}}])});