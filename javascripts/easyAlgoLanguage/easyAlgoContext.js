define(["easyAlgoRuntimeException","easyAlgoConfiguration"],function(e,t){var n="functions",r="vars",i="childs",s="getParent",o="La variable ",u="toLowerCase",a="getVar",f="value",l="length",c="ADD_AT_END",h=t.getFunctions(),p=function(e,t){e&&e.addChild(this),this.parent=e,this[n]={},this[r]={},this[i]=[],this.from=0,this.to=0,this.contextName=t};return p.prototype={setRange:function(e,t){this.from=e,this.to=t},addChild:function(e){this[i].push(e)},isset:function(t,n,i){t=t.toUpperCase();if(t in this[r])return!0;var u=this[s]()&&this[s]().isset(t,n,i);if(!u&&n)throw new e(o+t+" n'est pas definie.",i);return u||!1},issetFunction:function(t,r,i){var o=t[u](),a=o in h||o in this[n]||this[s]()&&this[s]().issetFunction(t);if(!a&&r)throw new e("La fonction "+t+" n'existe pas.",i);return a},getVar:function(e){return this[r][e]?this[r][e]:this[s]()?this[s]()[a](e):undefined},getFunction:function(e){var t=e[u]();return t in h?h[e]:t in this[n]?this[n][e]:this[s]()?this[s]().getFunction(e):undefined},getValue:function(e){return this[a](e)[f]},getType:function(e){return this[a](e).type},setValue:function(t,n,r){if(r!=undefined){if(this.getType(t)!="array"&&this.getType(t)!="string")throw new e(o+t+" n'est pas un tableau.");var i=this[a](t);i[f]==undefined&&(i[f]=[]);var s=i[f],u=r[l];if(u>1)for(var h=0;h<u-1;h++){var p=r[h];if(s[p]==undefined||p==c)p==c&&(p=s[l]),s[p]=[];s=s[p]}var d=r[r[l]-1];d==c?s.push(n):s[d]=n}else this[a](t)[f]=n},defineVar:function(e,t){this[r][e]={type:t,value:undefined}},getParent:function(){return this.parent},getAccessibleVars:function(){var e={};if(this[s]()){var t=this[s]().getAccessibleVars();for(var n in t)e[n]=t[n]}for(varName in this[r])e[varName]=this[r][varName].type;return e},getAccessibleFunctions:function(){var e={};if(this[s]()){var t=this[s]().getAccessibleFunctions();for(var r in t)e[r]=t[r]}for(functionName in this[n])e[functionName]=this[n][r];return e},getContextFor:function(e){for(var t in this[i]){var n=this[i][t];if(e>=n.from&&e<=n.to)return n.getContextFor(e)}return this},defineFunction:function(e,t,r){this[n][e[u]()]={parameters:t,body:r}}},p});